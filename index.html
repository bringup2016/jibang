<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertical Text Display</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #displayArea {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            font-size: 5vw;
            white-space: pre;
            writing-mode: vertical-rl;
            text-orientation: upright;
            word-wrap: break-word;
            position: relative;
        }

        #inputArea {
            display: flex;
            flex-direction: column;
            padding: 10px;
            border-top: 1px solid #ccc;
        }

        #inputArea textarea {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            resize: none;
            height: 100px;
        }

        #inputArea button {
            margin-top: 10px;
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .buttonGroup {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .buttonGroup button {
            flex: 1;
        }

        #fontSizeControls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        #fontSizeControls button {
            flex: 1;
        }

        .flame {
            position: absolute;
            bottom: 0;
            width: 50px;
            height: 50px;
            background: url('/jibang/assets/img/candle.gif') no-repeat center center;
            background-size: cover;
            animation: moveUp 1s linear forwards; /* 불꽃이 위로 올라감 */
            pointer-events: none; /* 마우스 이벤트 방해 안 함 */
        }


        @keyframes moveUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-300px); /* 화면 위로 이동 */
                opacity: 0;
            }
        }


        /* 모달 전체 화면 */
        .modal {
            display: none; /* 기본적으로 숨김 */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4); /* 반투명 배경 */
        }

        /* 모달 창 내부 콘텐츠 */
        .modal-content {
            background-color: #fff;
            margin: 15% auto; /* 중앙에 위치 */
            padding: 20px;
            border: 1px solid #888;
            width: 300px; /* 너비 설정 */
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* 모달 닫기 버튼 */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
        }

        /* 관계 버튼 스타일 */
        .relationOption {
            margin: 5px 0;
            padding: 10px;
            width: 100%;
            background-color: #f1f1f1;
            border: 1px solid #ddd;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
        }

        .relationOption:hover {
            background-color: #ddd;
        }


        /* 직위 버튼 스타일 */
        .positionOption {
            margin: 5px 0;
            padding: 10px;
            width: 100%;
            background-color: #f1f1f1;
            border: 1px solid #ddd;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
        }

        .positionOption:hover {
            background-color: #ddd;
        }


    </style>
</head>
<body>
<div id="displayArea">Write something...</div>
<div id="inputArea">
    <textarea id="textInput" placeholder="지방쓰기 버전 0.1"></textarea>
    <div class="buttonGroup">
        <button id="submitButton">지방쓰기</button>
        <button id="hanjaButton">한자변환</button>
    </div>
    <div class="buttonGroup">
        <button id="relationButton">1. 관계 선택</button>
        <button id="positionButton">2. 직위 선택</button>
    </div>
    <div id="fontSizeControls">
        <button id="increaseFontButton">글자 키우기</button>
        <button id="decreaseFontButton">글자 줄이기</button>
        <button id="newlineButton">줄바꿈</button>
    </div>
    <button id="clearButton">지방태우기</button>

</div>

<!-- 관계 선택 모달 -->
<div id="relationModal" class="modal">
    <div class="modal-content">
        <span id="closeModal" class="close">&times;</span>
        <h3>관계를 선택하세요</h3>
        <ul>
            <li>
                <button class="relationOption" data-text="顯考">아버지 현고(顯考)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯妣">어머니 현비(顯妣)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯祖考">조부 현조고(顯祖考)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯祖妣">조모 현조비(顯祖妣)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯曾祖考">증조부 현증조고(顯曾祖考)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯曾祖妣">증조모 현증조비(顯曾祖妣)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯高祖考">고조부 현고조고(顯高祖考)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯高祖妣">고조모 현고조비(顯高祖妣)</button>
            </li>
            <li>
                <button class="relationOption" data-text="顯辟">남편 현벽(顯辟)</button>
            </li>
            <li>
                <button class="relationOption" data-text="亡室">아내 망실(亡室)</button>
            </li>
            <li>
                <button class="relationOption" data-text="故室">아내 고실(故室)</button>
            </li>
            <li>
                <button class="relationOption" data-text="故室">형 현형(顯兄)</button>
            </li>
            <li>
                <button class="relationOption" data-text="亡弟">동생 망제(亡弟)</button>
            </li>
            <li>
                <button class="relationOption" data-text="故弟">동생 고제(故弟)</button>
            </li>
            <li>
                <button class="relationOption" data-text="亡子">자식 망자(亡子)</button>
            </li>
            <li>
                <button class="relationOption" data-text="故子">자식 고자(故子)</button>
            </li>
        </ul>
    </div>
</div>

<!-- 직위 선택 모달 -->
<div id="positionModal" class="modal">
    <div class="modal-content">
        <span id="closePositionModal" class="close">&times;</span>
        <h3>직위를 선택하세요</h3>
        <button id="infoButtonPosition" style="margin-bottom: 10px; padding: 5px 10px; font-size: 14px; cursor: pointer;">정보</button>
        <ul>
            <li>
                <button class="positionOption" data-text="學生">學生(학생)</button>
            </li>
            <li>
                <button class="positionOption" data-text="府君">府君(부군)</button>
            </li>
            <li>
                <button class="positionOption" data-text="貞敬夫人">貞敬夫人(정경부인)</button>
            </li>
            <li>
                <button class="positionOption" data-text="貞夫人">貞夫人(정부인)</button>
            </li>
            <li>
                <button class="positionOption" data-text="淑夫人">淑夫人(숙부인)</button>
            </li>
            <li>
                <button class="positionOption" data-text="孺人">孺人(유인)</button>
            </li>
            <li>
                <button class="positionOption" data-text="神位">신위(神位)</button>
            </li>
        </ul>
    </div>
</div>


<!-- 정보 팝업 모달 -->
<div id="infoModal" class="modal">
    <div class="modal-content">
        <span id="closeInfoModal" class="close">&times;</span>
        <p id="infoTextContents">
        </p>
    </div>
</div>



<script>
    const textInput = document.getElementById('textInput');
    const submitButton = document.getElementById('submitButton');
    const newlineButton = document.getElementById('newlineButton');
    const clearButton = document.getElementById('clearButton');
    const displayArea = document.getElementById('displayArea');
    const hanjaButton = document.getElementById('hanjaButton');
    const increaseFontButton = document.getElementById('increaseFontButton');
    const decreaseFontButton = document.getElementById('decreaseFontButton');

    //관계
    const relationButton = document.getElementById('relationButton');
    const modal = document.getElementById('relationModal');
    const closeModal = document.getElementById('closeModal');
    const relationOptions = document.querySelectorAll('.relationOption');

    //직위
    const positionButton = document.getElementById('positionButton');
    const positionModal = document.getElementById('positionModal');
    const closePositionModal = document.getElementById('closePositionModal');
    const positionOptions = document.querySelectorAll('.positionOption');

    //정보
    // const infoButton = document.getElementById('infoButton');
    const infoButtonPosition = document.getElementById('infoButtonPosition');
    const infoModal = document.getElementById('infoModal');
    const closeInfoModal = document.getElementById('closeInfoModal');



    let currentFontSize = 5; // 현재 글자 크기 (vw 단위)

    submitButton.addEventListener('click', () => {
        const text = textInput.value;
        displayArea.textContent = '';

        if (text.trim() !== '') {
            let index = 0;
            const typingEffect = setInterval(() => {
                if (index < text.length) {
                    displayArea.textContent += text[index++];
                } else {
                    clearInterval(typingEffect);
                }
            }, 100); // 글자 딜레이
        } else {
            displayArea.textContent = '지방쓰기 버전 0.1';
        }
        textInput.value = '';
    });

    newlineButton.addEventListener('click', () => {
        const currentText = textInput.value;
        textInput.value = currentText + '\n';
        textInput.focus();
        textInput.selectionStart = textInput.selectionEnd = textInput.value.length;
    });

    // 글자 지우기 및 불꽃 효과 추가
    clearButton.addEventListener('click', () => {
        clearButton.disabled = true;

        const text = displayArea.textContent; // 현재 화면의 글자
        displayArea.textContent = ''; // 화면 초기화 후 다시 글자 추가
        let index = 0;

        const interval = setInterval(() => {
            if (index >= text.length) {
                clearInterval(interval); // 모든 글자 삭제 후 멈춤
                clearButton.disabled = false;
                return;
            }

            // 화면의 글자를 하나씩 지우기
            displayArea.textContent = text.slice(index + 1);

            // 불꽃 애니메이션 추가
            const flame = document.createElement('div');
            flame.className = 'flame';
            flame.style.left = `${Math.random() * 80}%`; // 불꽃 위치를 화면 가운데로 조절
            flame.style.width = '40vw'; // 불꽃 크기
            flame.style.height = '40vw';

            displayArea.appendChild(flame); // 불꽃을 화면에 추가

            // 일정 시간이 지나면 불꽃 제거
            setTimeout(() => {
                displayArea.removeChild(flame); // 불꽃 삭제
            }, 1000);

            index++;
        }, 200); // 글자를 200ms 간격으로 순차적으로 지움
    });

    textInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            submitButton.click();
        }
    });

    hanjaButton.addEventListener('click', () => {
        const url = 'https://hanja.dict.naver.com/';
        window.open(url, '_blank');
    });

    // 글자 키우기 버튼
    increaseFontButton.addEventListener('click', () => {
        if (currentFontSize < 20) { // 최대 글자 크기 제한
            currentFontSize += 1;
            displayArea.style.fontSize = `${currentFontSize}vw`;
        }
    });

    // 글자 줄이기 버튼
    decreaseFontButton.addEventListener('click', () => {
        if (currentFontSize > 1) { // 최소 글자 크기 제한
            currentFontSize -= 1;
            displayArea.style.fontSize = `${currentFontSize}vw`;
        }
    });

    //// 모달 관련 코드

    // 관계 선택 버튼 클릭 시 모달 열기
    relationButton.addEventListener('click', () => {
        modal.style.display = 'block';
    });

    // 모달 닫기 버튼 클릭 시 모달 닫기
    closeModal.addEventListener('click', () => {
        modal.style.display = 'none';
    });

    // 관계 옵션 클릭 시 동작
    relationOptions.forEach(option => {
        option.addEventListener('click', (event) => {
            //const selectedRelation = event.target.textContent; // 선택된 관계 텍스트 가져오기
            const selectedRelation = event.target.getAttribute('data-text'); // `data-text`
            // `textInput` 필드에 선택된 텍스트 추가
            textInput.value += selectedRelation + ' ';
            modal.style.display = 'none'; // 모달 닫기
            textInput.focus(); // 텍스트 필드에 포커스
        });
    });

    // 화면의 어두운 영역 클릭 시 모달 닫기
    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });

    positionButton.addEventListener('click', () => {
        positionModal.style.display = 'block';
    });

    closePositionModal.addEventListener('click', () => {
        positionModal.style.display = 'none';
    });

    positionOptions.forEach(option => {
        option.addEventListener('click', (event) => {
            const selectedPosition = event.target.getAttribute('data-text');
            textInput.value += selectedPosition + ' ';
            positionModal.style.display = 'none';
            textInput.focus();
        });
    });

    window.addEventListener('click', (event) => {
        if (event.target === positionModal) {
            positionModal.style.display = 'none';
        }
    });


    // "정보" 버튼 클릭 시 팝업 열기
    infoButtonPosition.addEventListener('click', () => {
        const infoTextContents = document.getElementById('infoTextContents');
        infoTextContents.innerHTML = `1. 고인의 직위와 이름
            남자 조상이 벼슬을 한 경우에는 벼슬의 이름을 써주고, 벼슬을 안 한 경우에는 ‘學生(학생)’이라고 쓴다. <br>
            ‘學生(학생)’은 본래 관직이 없거나 과거시험을 준비하는 경우를 뜻하는데, 다만 과거제도가 없는 현대에는 특별한
            변형 없이 고인이 남성이라면 모두 '學生(학생)'으로 적는다. 그 다음에는 ‘府君(부군)’이라고 쓴다. <br><br>

            여자 조상은 남편의 벼슬 급에 따라 나라로부터 부여 받은 貞敬夫人(정경부인)·貞夫人(정부인)·淑夫人(숙부인)
            등의 호칭을 쓰면 되는데, 일정한 봉작이 없다면 ‘孺人(유인)’이라 적는다. 그 다음에 고인의 이름을 쓰는 부분에는
            본관과 성씨(예. 김해 김씨)를 적는다.<br>
            <br><br>
            2. 신위(神位)<br>

            지방의 맨끝에는 공통적으로 '신위(神位)'라고 써야 한다. 여기서 신위는 제사를 지내는 주인공이 위치할 곳이라는 뜻이다.<br>
            <br><br><br>
            <a href="https://terms.naver.com/entry.naver?docId=5952402&cid=43667&categoryId=43667" target="_blank"> [네이버 지식백과] 지방 쓰는 법 (시사상식사전, pmg 지식엔진연구소) </a>`;
        infoModal.style.display = 'block';
    });

    // 정보 팝업 닫기 버튼 클릭 시 팝업 닫기
    closeInfoModal.addEventListener('click', () => {
        infoModal.style.display = 'none';
    });

    // 화면의 어두운 영역 클릭 시 정보 팝업 닫기
    window.addEventListener('click', (event) => {
        if (event.target === infoModal) {
            infoModal.style.display = 'none';
        }
    });



</script>

</body>
</html>
